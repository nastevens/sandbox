from dateexpression import DateExpr
from datetime import date

TEST_CASES = [
    ('days', 1, (2011, 1,  31), (2011, 2,  1 ), (2011, 2,  2 )), # january
    ('days', 1, (2012, 2,  28), (2012, 2,  29), (2012, 3,  1 )), # leap year
    ('days', 1, (2013, 2,  28), (2013, 3,  1 ), (2013, 3,  2 )), # no leap year
    ('days', 1, (2014, 3,  31), (2014, 4,  1 ), (2014, 4,  2 )), # march
    ('days', 1, (2015, 4,  30), (2015, 5,  1 ), (2015, 5,  2 )), # april
    ('days', 1, (2016, 5,  31), (2016, 6,  1 ), (2016, 6,  2 )), # may
    ('days', 1, (2017, 6,  30), (2017, 7,  1 ), (2017, 7,  2 )), # june
    ('days', 1, (2018, 7,  31), (2018, 8,  1 ), (2018, 8,  2 )), # july
    ('days', 1, (2019, 8,  31), (2019, 9,  1 ), (2019, 9,  2 )), # august
    ('days', 1, (2020, 9,  30), (2020, 10, 1 ), (2020, 10, 2 )), # september
    ('days', 1, (2021, 10, 31), (2021, 11, 1 ), (2021, 11, 2 )), # october
    ('days', 1, (2022, 11, 30), (2022, 12, 1 ), (2022, 12, 2 )), # november
    ('days', 1, (2023, 12, 31), (2024, 1,  1 ), (2024, 1,  2 )), # year roll
    ('days', 5, (2011, 12, 23), (2011, 12, 28), (2012, 1,  2 ),  # 5 days + ly
                (2012, 1,  7 ), (2012, 1,  12), (2012, 1,  17),
                (2012, 1,  22), (2012, 1,  27), (2012, 2,  1 ),
                (2012, 2,  6 ), (2012, 2,  11), (2012, 2,  16),
                (2012, 2,  21), (2012, 2,  26), (2012, 3,  2 )
    ),

    ('months', 1, (2011, 1, 31),  (2011, 2, 28),  (2011, 3, 31)),  # january
    ('months', 1, (2012, 1, 31),  (2012, 2, 29),  (2012, 3, 31)),  # leap year
    ('months', 1, (2013, 2, 28),  (2013, 3, 28),  (2013, 4, 28)),  # no leap year
    ('months', 1, (2014, 3, 31),  (2014, 4, 30),  (2014, 5, 31)),  # march
    ('months', 1, (2015, 4, 30),  (2015, 5, 30),  (2015, 6, 30)),  # april
    ('months', 1, (2016, 5, 31),  (2016, 6, 30),  (2016, 7, 31)),  # may
    ('months', 1, (2017, 6, 30),  (2017, 7, 30),  (2017, 8, 30)),  # june
    ('months', 1, (2018, 7, 31),  (2018, 8, 31),  (2018, 9, 30)),  # july
    ('months', 1, (2019, 8, 31),  (2019, 9, 30),  (2019, 10, 31)), # august
    ('months', 1, (2020, 9, 30),  (2020, 10, 30), (2020, 11, 30)), # september
    ('months', 1, (2021, 10, 31), (2021, 11, 30), (2021, 12, 31)), # october
    ('months', 1, (2022, 11, 30), (2022, 12, 30), (2023, 1, 30)),  # november

    ('years', 1, (2011, 2, 28), (2012, 2, 28), (2013, 2, 28)),
    ('years', 1, (2012, 2, 29), (2013, 2, 28), (2014, 2, 28),
                 (2015, 2, 28), (2016, 2, 29), (2017, 2, 28)),
]

NEW_TEST_CASES = [


def test_date_calculations():
    for case in TEST_CASES:
        yield (check_iter, ) + case

def check_iter(type_, increment, start, *expected):
    de = DateExpr(type_, increment)
    it = de.ifromdate(*start)
    for expect in expected:
        assert next(it) == date(*expect)
